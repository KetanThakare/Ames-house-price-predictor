

#handling multicollinearity
ah_data_sf = ah_data[selected_features]
ah_data_sf = pd.get_dummies(ah_data_sf)

from statsmodels.stats.outliers_influence import variance_inflation_factor

vif = pd.DataFrame()
vif["VIF_Factors"] = [variance_inflation_factor(ah_data_sf.values, i) for i in range(ah_data_sf.shape[1])]
vif["Features"] = ah_data_sf.columns